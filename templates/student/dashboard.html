{% extends 'base.html' %}
{% block title %}Student Dashboard{% endblock %}
{% block content %}
<div class="page-header">
  <div class="title-block">
    <span class="kicker">Overview</span>
    <h3 class="mb-0">Student Dashboard</h3>
  </div>
  <a class="btn btn-gradient" href="{% url 'books:list' %}"><i class="bi bi-search me-1"></i>Browse Books</a>
</div>

<div class="row g-3 mb-3">
  <div class="col-md-6 animate-fade-in">
    <div class="card-modern card-ghost h-100">
      <div class="card-header d-flex justify-content-between align-items-center">
        <span>Latest Books</span>
        <a class="btn btn-sm btn-outline-dark" href="{% url 'books:list' %}">View all</a>
      </div>
      <div class="card-body">
        {% for book in latest_books %}
        <div class="d-flex justify-content-between align-items-start border-bottom py-2">
          <div>
            <div class="fw-semibold">{{ book.title }}</div>
            <div class="text-muted small">{{ book.author.name }} Â· {{ book.category }}</div>
          </div>
          {% if book.is_available %}<span class="badge badge-status badge-available">Available</span>{% else %}<span class="badge badge-status badge-overdue">Out</span>{% endif %}
        </div>
        {% empty %}<p class="text-muted">No books yet.</p>{% endfor %}
      </div>
    </div>
  </div>
  <div class="col-md-6 animate-fade-in" style="animation-delay:.05s;">
    <div class="card-modern card-ghost h-100">
      <div class="card-header d-flex justify-content-between align-items-center">
        <span>My Issues</span>
        <a class="btn btn-sm btn-outline-dark" href="{% url 'transactions:my-issues' %}">Open list</a>
      </div>
      <div class="card-body">
        {% for issue in my_issues %}
        <div class="d-flex justify-content-between align-items-start border-bottom py-2">
          <div>
            <div class="fw-semibold">{{ issue.book.title }}</div>
            <div class="small text-muted">Due: {{ issue.due_date|default:'-' }}</div>
          </div>
          {% if issue.is_overdue %}<span class="badge badge-status badge-overdue">Overdue</span>{% else %}<span class="badge badge-status badge-issued">{{ issue.status }}</span>{% endif %}
        </div>
        {% empty %}<p class="text-muted">No issued books yet.</p>{% endfor %}
      </div>
    </div>
  </div>
</div>

<div class="card-modern card-gradient">
  <div class="card-body d-flex justify-content-between align-items-center">
    <div>
      <p class="mini-label mb-1 text-white-50">Stay ahead</p>
      <h5 class="mb-1">Return reminders with pulse animation</h5>
      <p class="mb-0 text-white-75">Watch overdue items glow so you never miss a deadline.</p>
    </div>
    <span class="badge badge-overdue animate-pulse-soft">{{ my_issues|length }} active</span>
  </div>
</div>
{% endblock %}
