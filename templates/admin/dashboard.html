{% extends 'base.html' %}
{% block title %}Admin Dashboard{% endblock %}
{% block content %}
<div class="page-header">
  <div class="title-block">
    <span class="kicker">Admin Overview</span>
    <h3 class="mb-0">Dashboard</h3>
  </div>
  <div class="action-stack">
    <a class="btn btn-outline-dark" href="{% url 'transactions:issue-requests' %}"><i class="bi bi-inbox me-1"></i>Requests</a>
    <a class="btn btn-gradient" href="{% url 'books:manage-books' %}"><i class="bi bi-journal-text me-1"></i>Manage Books</a>
  </div>
</div>

<div class="stat-grid mb-4">
  <div class="stat-card animate-fade-in">
    <div class="icon"><i class="bi bi-collection"></i></div>
    <p class="mini-label mb-1">Total Books</p>
    <h3>{{ stats.total_books }}</h3>
  </div>
  <div class="stat-card animate-fade-in" style="animation-delay:.05s;">
    <div class="icon"><i class="bi bi-box-arrow-up-right"></i></div>
    <p class="mini-label mb-1">Issued</p>
    <h3>{{ stats.issued_books }}</h3>
  </div>
  <div class="stat-card animate-fade-in" style="animation-delay:.1s;">
    <div class="icon"><i class="bi bi-people"></i></div>
    <p class="mini-label mb-1">Students</p>
    <h3>{{ stats.students }}</h3>
  </div>
  <div class="stat-card animate-fade-in" style="animation-delay:.15s;">
    <div class="icon"><i class="bi bi-exclamation-octagon"></i></div>
    <p class="mini-label mb-1">Overdue</p>
    <h3>{{ stats.overdue }}</h3>
  </div>
</div>

<div class="row g-3">
  <div class="col-lg-7">
    <div class="card-modern card-ghost h-100">
      <div class="card-header d-flex justify-content-between align-items-center">
        <span>Recent Requests</span>
        <a class="btn btn-sm btn-gradient" href="{% url 'transactions:issue-requests' %}">View All</a>
      </div>
      <div class="card-body table-responsive table-modern">
        <table class="table table-modern-striped align-middle mb-0">
          <thead><tr><th>Book</th><th>User</th><th>Status</th><th>Requested</th></tr></thead>
          <tbody>
            {% for req in recent_requests %}
            <tr>
              <td>{{ req.book.title }}</td>
              <td>{{ req.user.username }}</td>
              <td><span class="badge-status badge-issued">{{ req.status }}</span></td>
              <td>{{ req.created_at|date:'Y-m-d H:i' }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="4" class="text-center text-muted">No requests yet.</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
  <div class="col-lg-5">
    <div class="card-modern card-gradient mb-3">
      <div class="card-body">
        <p class="mini-label mb-1 text-white-50">Load</p>
        <h5 class="mb-2">Circulation Pulse</h5>
        <div class="card-placeholder-chart"></div>
      </div>
    </div>
    <div class="card-modern card-ghost">
      <div class="card-body d-flex align-items-center justify-content-between">
        <div>
          <p class="mini-label mb-1">Overdue alert</p>
          <h6 class="mb-1">Pulse animation for quick glance</h6>
          <p class="mb-0 text-muted-soft">Keep staff aware of returns approaching deadlines.</p>
        </div>
        <span class="badge badge-overdue animate-pulse-soft">{{ stats.overdue }} overdue</span>
      </div>
    </div>
  </div>
</div>
{% endblock %}
