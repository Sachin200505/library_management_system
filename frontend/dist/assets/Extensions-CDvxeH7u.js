import{r as l,j as e,C as c,X as y}from"./index-B0U1T1C1.js";import{E as x}from"./extension.service-Kj7yH7fP.js";import{I as w}from"./issue.service-CORyrTen.js";import{P as u}from"./plus-l3sj6by8.js";import{B as v}from"./book-open-CIpCioG8.js";const _=()=>{const[o,m]=l.useState([]),[h,b]=l.useState([]),[p,f]=l.useState(!0),[i,r]=l.useState(!1),[t,n]=l.useState({issue_id:"",days_requested:7,reason:""});l.useEffect(()=>{d()},[]);const d=async()=>{try{const[s,a]=await Promise.all([x.getAll(),w.getAll()]);m(s.results||s);const j=(a.results||a).filter(N=>N.status==="ISSUED");b(j)}catch(s){console.error("Error fetching data",s)}finally{f(!1)}},g=async s=>{s.preventDefault();try{await x.request({issue:t.issue_id,days_requested:t.days_requested,reason:t.reason}),r(!1),n({issue_id:"",days_requested:7,reason:""}),d()}catch(a){console.error("Error submitting request",a),alert("Failed to submit request")}};return p?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500"})}):e.jsxs("div",{className:"space-y-8 animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center bg-white/50 p-6 rounded-2xl glass-card shadow-lg backdrop-blur-md border border-white/20 sticky top-0 z-10 w-full",children:[e.jsxs("h1",{className:"text-3xl font-bold text-slate-800 flex items-center gap-3 font-heading",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(c,{className:"text-blue-600 w-8 h-8"})}),"My Extensions"]}),e.jsxs("button",{onClick:()=>r(!i),className:"flex items-center gap-2 px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-xl shadow-lg shadow-blue-500/30 transform hover:-translate-y-0.5 transition-all",children:[e.jsx(u,{className:"w-5 h-5"}),"Request Extension"]})]}),i&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm animate-fade-in",children:e.jsxs("div",{className:"glass-card bg-white w-full max-w-lg p-8 rounded-2xl shadow-2xl relative animate-slide-up",children:[e.jsx("button",{onClick:()=>r(!1),className:"absolute top-4 right-4 p-2 rounded-full hover:bg-slate-100 text-slate-400 hover:text-slate-600 transition-colors",children:e.jsx(y,{className:"w-6 h-6"})}),e.jsxs("h2",{className:"text-2xl font-bold text-slate-800 mb-6 flex items-center gap-3 font-heading",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(u,{className:"w-6 h-6 text-blue-600"})}),"New Extension Request"]}),e.jsxs("form",{onSubmit:g,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Select Book"}),e.jsxs("select",{value:t.issue_id,onChange:s=>n({...t,issue_id:s.target.value}),className:"w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl text-slate-800 focus:ring-2 focus:ring-blue-500 focus:bg-white outline-none transition-all cursor-pointer",required:!0,children:[e.jsx("option",{value:"",children:"Select a book..."}),h.map(s=>{var a;return e.jsxs("option",{value:s.id,children:[(a=s.book)==null?void 0:a.title," (Due: ",s.due_date,")"]},s.id)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Days Requested"}),e.jsx("input",{type:"number",min:"1",max:"14",value:t.days_requested,onChange:s=>n({...t,days_requested:s.target.value}),className:"w-full px-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl text-slate-800 focus:ring-2 focus:ring-blue-500 focus:bg-white outline-none transition-all",required:!0}),e.jsx("p",{className:"text-xs text-slate-500",children:"Maximum 14 days per extension."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Reason"}),e.jsx("textarea",{value:t.reason,onChange:s=>n({...t,reason:s.target.value}),className:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-slate-800 focus:ring-2 focus:ring-blue-500 focus:bg-white outline-none h-24 resize-none transition-all",placeholder:"Why do you need an extension?",required:!0})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-100",children:[e.jsx("button",{type:"button",onClick:()=>r(!1),className:"px-6 py-2.5 text-slate-600 hover:text-slate-800 font-medium hover:bg-slate-100 rounded-xl transition-all",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-8 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-xl shadow-lg shadow-blue-500/30 transform hover:-translate-y-0.5 transition-all",children:"Submit Request"})]})]})]})}),e.jsx("div",{className:"glass-card bg-white rounded-2xl overflow-hidden shadow-xl border border-slate-100",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Book Details"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Requested Days"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Date"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[o.map(s=>e.jsxs("tr",{className:"hover:bg-slate-50/80 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-slate-100 rounded-lg text-slate-500",children:e.jsx(v,{className:"w-4 h-4"})}),e.jsx("span",{className:"font-semibold text-slate-700",children:s.issue_book_title||"Unknown Title"})]})}),e.jsxs("td",{className:"px-6 py-4 text-slate-600 font-medium",children:[s.days_requested," Days"]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold border ${s.status==="APPROVED"?"bg-green-100 text-green-700 border-green-200":s.status==="REJECTED"?"bg-red-100 text-red-700 border-red-200":"bg-amber-100 text-amber-700 border-amber-200"}`,children:s.status})}),e.jsx("td",{className:"px-6 py-4 text-sm text-slate-500",children:new Date(s.created_at).toLocaleDateString()})]},s.id)),o.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"px-6 py-16 text-center text-slate-500",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(c,{className:"w-8 h-8 text-slate-300"})}),e.jsx("p",{className:"font-medium",children:"No extension requests found."})]})})})]})]})})})]})};export{_ as default};
