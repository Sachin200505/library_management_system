import{r as l,j as e,C as n,X as u}from"./index-B0U1T1C1.js";import{I as c}from"./issue.service-CORyrTen.js";import{C as j}from"./check-Ce-VbAi1.js";const N=()=>{const[o,d]=l.useState([]),[i,x]=l.useState(!0);l.useEffect(()=>{a()},[]);const a=async()=>{try{const s=await c.getAll(),r=(s.results||s).filter(p=>p.status==="REQUESTED");d(r)}catch(s){console.error("Error fetching requests",s)}finally{x(!1)}},h=async s=>{try{await c.approveIssue(s),a()}catch(t){console.error("Error approving request",t),alert("Failed to approve request. Book might be out of stock.")}},m=async s=>{if(window.confirm("Are you sure you want to reject this request?"))try{await c.rejectIssue(s),a()}catch(t){console.error("Error rejecting request",t),alert("Failed to reject request.")}};return i?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500"})}):e.jsxs("div",{className:"space-y-8 animate-fade-in",children:[e.jsx("div",{className:"flex justify-between items-center bg-white/50 p-6 rounded-2xl glass-card shadow-lg backdrop-blur-md border border-white/20 sticky top-0 z-10 w-full text-slate-800",children:e.jsxs("h1",{className:"text-3xl font-bold text-slate-800 flex items-center gap-3 font-heading",children:[e.jsx("div",{className:"p-2 bg-amber-100 rounded-lg",children:e.jsx(n,{className:"text-amber-600 w-8 h-8"})}),"Issue Requests"]})}),e.jsx("div",{className:"glass-card bg-white rounded-2xl overflow-hidden shadow-xl border border-slate-100",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Book"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Requested Date"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[o.map(s=>{var t,r;return e.jsxs("tr",{className:"hover:bg-slate-50/80 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 font-semibold text-slate-800",children:(t=s.user)==null?void 0:t.username}),e.jsx("td",{className:"px-6 py-4 text-slate-700",children:(r=s.book)==null?void 0:r.title}),e.jsx("td",{className:"px-6 py-4 text-slate-500",children:new Date(s.created_at||Date.now()).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>h(s.id),className:"p-2 bg-green-50 text-green-600 hover:bg-green-100 rounded-lg transition-colors border border-green-200",title:"Approve",children:e.jsx(j,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>m(s.id),className:"p-2 bg-red-50 text-red-600 hover:bg-red-100 rounded-lg transition-colors border border-red-200",title:"Reject",children:e.jsx(u,{className:"w-4 h-4"})})]})})]},s.id)}),o.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"px-6 py-16 text-center text-slate-500",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(n,{className:"w-8 h-8 text-slate-300"})}),e.jsx("p",{className:"font-medium",children:"No pending requests."})]})})})]})]})})})]})};export{N as default};
