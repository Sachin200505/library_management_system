import{c as f,u as j,r as l,j as e,M as x}from"./index-B0U1T1C1.js";import{R as m}from"./review.service-CCNSrpAY.js";import{S as g}from"./shield-check-Bj171qGn.js";import{S as N}from"./star-CfixiURX.js";import{C as y}from"./check-Ce-VbAi1.js";const w=f("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),A=()=>{var i,o;const{user:s}=j(),[d,p]=l.useState([]),[h,u]=l.useState(!0),a=((i=s==null?void 0:s.profile)==null?void 0:i.is_admin)||((o=s==null?void 0:s.profile)==null?void 0:o.is_owner);l.useEffect(()=>{c()},[]);const c=async()=>{try{const t=await m.getAll();p(t.results||t)}catch(t){console.error("Error fetching reviews",t)}finally{u(!1)}},n=async(t,r)=>{try{await m.updateStatus(t,r),c()}catch(b){console.error("Error updating review status",b),alert("Failed to update status.")}};return h?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500"})}):e.jsxs("div",{className:"space-y-8 animate-fade-in pb-10",children:[e.jsxs("div",{className:"flex justify-between items-center bg-white/50 p-6 rounded-2xl glass-card shadow-lg backdrop-blur-md border border-white/20 sticky top-0 z-10 w-full text-slate-800",children:[e.jsxs("h1",{className:"text-3xl font-bold text-slate-800 flex items-center gap-3 font-heading",children:[e.jsx("div",{className:`p-2 ${a?"bg-blue-100 text-blue-600":"bg-purple-100 text-purple-600"} rounded-lg`,children:a?e.jsx(g,{className:"w-8 h-8"}):e.jsx(x,{className:"w-8 h-8"})}),a?"Review Moderation":"Community Reviews"]}),!a&&e.jsx("p",{className:"text-slate-500 font-medium hidden md:block",children:"Sharing experiences, building a better library."})]}),e.jsx("div",{className:"glass-card bg-white rounded-2xl overflow-hidden shadow-xl border border-slate-100",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Book"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Rating"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Review"}),e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider",children:"Status"}),a&&e.jsx("th",{className:"px-6 py-4 text-xs font-bold text-slate-500 uppercase tracking-wider text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[d.map(t=>{var r;return e.jsxs("tr",{className:"hover:bg-slate-50/80 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 font-semibold text-slate-800",children:t.book_title||((r=t.book)==null?void 0:r.title)}),e.jsx("td",{className:"px-6 py-4 text-slate-600 font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-slate-100 flex items-center justify-center text-[10px] font-bold text-slate-500 border border-slate-200",children:(t.user_username||"U").charAt(0).toUpperCase()}),t.user_username,t.user===(s==null?void 0:s.id)&&e.jsx("span",{className:"text-[10px] bg-blue-50 text-blue-600 px-1.5 py-0.5 rounded-full font-bold border border-blue-100",children:"You"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center text-amber-500",children:[e.jsx("span",{className:"mr-1 font-bold",children:t.rating}),e.jsx(N,{className:"w-4 h-4 fill-current"})]})}),e.jsx("td",{className:"px-6 py-4 max-w-xs truncate text-slate-600",title:t.text,children:t.text||"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-[10px] font-bold border shadow-sm uppercase tracking-wider
                                            ${t.status==="APPROVED"?"bg-green-50 text-green-700 border-green-200":t.status==="HIDDEN"?"bg-slate-100 text-slate-600 border-slate-200":"bg-amber-50 text-amber-700 border-amber-200"}`,children:t.status})}),a&&e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[t.status!=="APPROVED"&&e.jsx("button",{onClick:()=>n(t.id,"APPROVED"),className:"p-2 bg-green-50 text-green-600 hover:bg-green-100 rounded-lg transition-colors border border-green-200",title:"Approve",children:e.jsx(y,{className:"w-4 h-4"})}),t.status!=="HIDDEN"&&e.jsx("button",{onClick:()=>n(t.id,"HIDDEN"),className:"p-2 bg-slate-50 text-slate-600 hover:bg-slate-100 rounded-lg transition-colors border border-slate-200",title:"Hide",children:e.jsx(w,{className:"w-4 h-4"})})]})})]},t.id)}),d.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:a?"6":"5",className:"px-6 py-16 text-center text-slate-500",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mb-4 border border-dashed border-slate-300",children:e.jsx(x,{className:"w-8 h-8 text-slate-300"})}),e.jsx("p",{className:"font-medium",children:"No reviews found."}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Be the first to share your experience!"})]})})})]})]})})})]})};export{A as default};
